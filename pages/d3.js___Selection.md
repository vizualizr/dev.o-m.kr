date-created:: [[2025-11-10]]
date-modified::
division:: [[makr]]
stack:: frontend
tags:: 
type::
status:: [[ai-generated]]

- ## Summary
	- D3.js의 **`Selection` 객체**는 단순한 배열이 아니라, **데이터가 바인딩된 실제 DOM 요소들의 집합을 감싸고 있는(Wrapping) 특수한 객체**이다.
	- 이 객체는 내부적으로 DOM 요소들을 관리하며, 이들에게 일괄적으로 명령을 내릴 수 있는 전용 메서드(`.attr`, `.append` 등)를 제공한다.
- ## Characteristics
	- ### **1. 래퍼(Wrapper) 객체**
		- Selection은 브라우저의 실제 DOM 요소(`SVGGElement`, `HTMLDivElement` 등)들을 직접 포함하는 것이 아니라, 이들에 대한 참조를 내부 구조(`_groups` 등)에 저장하여 관리한다.
		- **개념적 구조 예시:**
		  ```javascript
		  // d3.selectAll("circle") 실행 시 내부 구조 (단순화)
		  const selection = {
		    _groups: [
		      [
		        <circle class="a">, // 실제 DOM 요소 참조
		        <circle class="b">,
		        <circle class="c">
		      ]
		    ],
		    _parents: [html],
		    // D3 메서드들이 프로토타입에 정의됨
		    attr: function(name, value) { /* ... */ },
		    style: function(name, value) { /* ... */ }
		  };
		  ```
	- ### **2. 데이터 바인딩의 실체 (`__data__`)**
		- Selection 객체가 데이터를 별도로 들고 있는 것이 아니다.
		- 실제로는 각 DOM 요소 객체 자체에 **`__data__`**라는 숨겨진 속성이 추가되어, 그 요소와 짝지어진 개별 데이터가 저장된다.
		- **코드 예시:**
		  ```javascript
		  d3.selectAll("div").data([10, 20, 30]);
		  
		  // 브라우저 콘솔에서 첫 번째 div 요소를 확인해보면:
		  const firstDiv = document.querySelector("div");
		  console.log(firstDiv.__data__); // 10 (바인딩된 데이터가 직접 저장되어 있음)
		  ```
	- ### **3. 자동 순회 (Mass Action)**
		- Selection 객체를 호출하는 메서드(예: `.attr("width", d => d.value)`)는 Selection이 포함하고 있는 **모든 DOM 요소를 자동으로 순회**하며 개별적으로 실행된다.
		- **D3 코드 vs 의사 코드 비교:**
		  ```javascript
		  // [D3 코드] 한 줄로 모든 요소 처리
		  d3.selectAll("rect").attr("width", d => d.value * 10);
		  
		  // [실제 동작을 풀어서 쓴 의사 코드]
		  for (let i = 0; i < selection._groups[0].length; i++) {
		    const element = selection._groups[0][i]; // 1. 개별 DOM 요소 꺼내기
		    const data = element.__data__;           // 2. 바인딩된 데이터 꺼내기
		    const calculatedWidth = data.value * 10; // 3. 콜백 함수 실행하여 값 계산
		    element.setAttribute("width", calculatedWidth); // 4. 실제 DOM 속성 변경
		  }
		  ```
- ## log
	- [[2025-11-10]] Page created.
- ### References
	- [d3-selection | D3 by Observable](https://d3js.org/d3-selection)